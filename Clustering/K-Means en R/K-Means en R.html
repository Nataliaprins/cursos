<!DOCTYPE html>
<html class="writer-html5" lang="y" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>K-Means en R &mdash; Material Curso 1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Clusters Jerárquicos" href="../Clustering%20jerarquico/Cluster_jer%C3%A1rquico.html" />
    <link rel="prev" title="Teoría K-Means" href="../Teor%C3%ADa%20K-Means/Teor%C3%ADa%20K-Means.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Material Curso
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Análisis de datos:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Introducci%C3%B3n%20a%20R/index.html">Introducción a R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ggplot2/index.html">ggplot2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Regresi%C3%B3n%20lineal/index.html">Regresión lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Multivariado/index.html">Análisis Multivariado</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Series%20de%20tiempo/index.html">Series de tiempo</a></li>
</ul>
<p class="caption"><span class="caption-text">Análisis exploratorio de datos:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20gr%C3%A1fico/index.html">Análisis gráfico</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20multivariado%20de%20datos/index.html">Análisis multivariado de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20de%20componentes%20principales/index.html">Análisis de componentes principales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20factorial/index.html">Análisis Factorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Clustering</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Teor%C3%ADa%20K-Means/Teor%C3%ADa%20K-Means.html">Teoría K-Means</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">K-Means en R</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#escalamiento-de-variables">Escalamiento de variables:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#k-means">K-Means:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numero-optimo-de-clusters">Número óptimo de clusters:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#metodo-de-la-silueta">Método de la silueta:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#metodo-del-gap-estadistico">Método del gap estadístico:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aplicacion-del-k-means-con-k-optimo">Aplicación del K-Means con k óptimo:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Clustering%20jerarquico/Cluster_jer%C3%A1rquico.html">Clusters Jerárquicos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cluster%20jer%C3%A1rquico%20en%20R/Cluster%20jer%C3%A1rquico%20en%20R.html">Cluster jerárquico en R</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Taller%20clustering/Taller%20An%C3%A1lisis%20Clustering.html">Taller Análisis Clustering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Escalamiento%20Multidimensional/index.html">Escalamiento Multidimensional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Datos%20faltantes/index.html">Datos faltantes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lsis%20de%20correspondencia/index.html">Análisis de correspondencia</a></li>
</ul>
<p class="caption"><span class="caption-text">Teoría de portafolios:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Generalidades%20del%20Mercado%20Colombiano/index.html">Generalidades del Mercado Colombiano</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Manejo%20de%20R-Studio/index.html">Conceptos Previos: Introducción a R y R-Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Conceptos%20B%C3%A1sicos%20de%20Estad%C3%ADstica/index.html">Conceptos Básicos de Estadística</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Teor%C3%ADa%20de%20Portafolios/index.html">Teoría de Portafolios</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Selecci%C3%B3n%20de%20Carteras/index.html">Selección de Cartera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Mercado%20de%20Renta%20Fija/index.html">Mercado de Renta fija</a></li>
</ul>
<p class="caption"><span class="caption-text">Modelación:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Caracterizaci%C3%B3n%20de%20las%20series%20de%20tiempo/index.html">Caracterización de las series de tiempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Modelos%20autorregresivos/index.html">ARIMA: autoregresivo integrado de medias móviles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Deep%20Learning%20para%20pron%C3%B3stico/index.html">Deep Learning para pronóstico</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Material Curso</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../Multivariado/index.html">Análisis Multivariado</a> &raquo;</li>
          <li><a href="../index.html">Clustering</a> &raquo;</li>
      <li>K-Means en R</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Clustering/K-Means en R/K-Means en R.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="k-means-en-r">
<h1>K-Means en R<a class="headerlink" href="#k-means-en-r" title="Permalink to this headline"></a></h1>
<p><strong>Importar datos:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;EAM_2019-v2.csv&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;;&quot;</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">datos</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">ï</span><span class="o">..</span><span class="n">gasto_personal</span> <span class="n">inversion_AF</span>    <span class="n">ventas</span>
<span class="mi">1</span>          <span class="mi">32334949</span>     <span class="mi">92544622</span> <span class="mi">321070109</span>
<span class="mi">2</span>           <span class="mi">5669798</span>     <span class="mi">69317638</span>  <span class="mi">86597330</span>
<span class="mi">3</span>          <span class="mi">11081213</span>     <span class="mi">50853587</span>  <span class="mi">26727389</span>
<span class="mi">4</span>          <span class="mi">47892609</span>     <span class="mi">42426113</span> <span class="mi">388005721</span>
<span class="mi">5</span>          <span class="mi">56410101</span>     <span class="mi">35164028</span> <span class="mi">390070138</span>
<span class="mi">6</span>          <span class="mi">20536798</span>     <span class="mi">27028346</span> <span class="mi">490639882</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dim</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
</pre></div>
</div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>216</li><li>3</li></ol><div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">str</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&#39;data.frame&#39;:       216 obs. of  3 variables:
 $ ï..gasto_personal: int  32334949 5669798 11081213 47892609 56410101 20536798 14001910 38533922 21397321 3478034 ...
 $ inversion_AF     : int  92544622 69317638 50853587 42426113 35164028 27028346 25150313 23019658 22007282 21924323 ...
 $ ventas           : int  321070109 86597330 26727389 388005721 390070138 490639882 379365700 488079500 233432780 9932602 ...
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">colnames</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Gasto_personal&quot;</span><span class="p">,</span> <span class="s">&quot;Inversión_AF&quot;</span><span class="p">,</span> <span class="s">&quot;Ventas&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Creamos una variable para almacenar solo las variables que queremos
analizar.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">&lt;-</span> <span class="n">datos</span><span class="p">[,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Gasto_personal&quot;</span><span class="p">,</span> <span class="s">&quot;Ventas&quot;</span><span class="p">)]</span>
</pre></div>
</div>
<p><strong>Dispersión de los datos:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Gasto_personal</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ventas</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_10_01.png"><img alt="../../_images/output_10_01.png" src="../../_images/output_10_01.png" style="width: 420px; height: 420px;" /></a>
<div class="section" id="escalamiento-de-variables">
<h2>Escalamiento de variables:<a class="headerlink" href="#escalamiento-de-variables" title="Permalink to this headline"></a></h2>
<p>Para Normalizar usaremos la función <code class="docutils literal notranslate"><span class="pre">scale()</span></code>.</p>
<div class="math notranslate nohighlight">
\[Normalización = X_{norm} = \frac{x_i-\overline{x}}{\sigma_x}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df_scaled</span> <span class="o">&lt;-</span> <span class="nf">scale</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df_scaled</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">)</span>  <span class="c1"># Data Frame para ggplot2</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Gasto_personal</span>     <span class="n">Ventas</span>
<span class="mi">1</span>     <span class="mf">1.52915807</span>  <span class="mf">1.9822451</span>
<span class="mi">2</span>    <span class="o">-</span><span class="mf">0.47700945</span> <span class="o">-</span><span class="mf">0.1241207</span>
<span class="mi">3</span>    <span class="o">-</span><span class="mf">0.06987862</span> <span class="o">-</span><span class="mf">0.6619571</span>
<span class="mi">4</span>     <span class="mf">2.69964731</span>  <span class="mf">2.5835553</span>
<span class="mi">5</span>     <span class="mf">3.34046558</span>  <span class="mf">2.6021008</span>
<span class="mi">6</span>     <span class="mf">0.64151759</span>  <span class="mf">3.5055604</span>
</pre></div>
</div>
<p><strong>Dispersión de los datos escalados:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df_scaled</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Gasto_personal</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Ventas</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_15_01.png"><img alt="../../_images/output_15_01.png" src="../../_images/output_15_01.png" style="width: 420px; height: 420px;" /></a>
<p><strong>Distancia Euclideana:</strong></p>
<div class="math notranslate nohighlight">
\[D_1(x_i, x_j) =\sqrt{\sum_{k=1}^p{(x_{ix}-x_{jx})^2}}\]</div>
<p>Con la función <code class="docutils literal notranslate"><span class="pre">dist()</span></code> podemos calcular diferentes distancias con el
argumento <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;euclidean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;manhattan&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;minkowski&quot;</span></code>, entre otros. Cuando se usa la distancia <code class="docutils literal notranslate"><span class="pre">&quot;minkowski&quot;</span></code>
se debe agregar el argumento <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span></code>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">dist_eucl</span> <span class="o">&lt;-</span> <span class="nf">dist</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;euclidean&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Matriz de distancias:</strong></p>
<p>De forma matricial se muestran las distancias entre todas las
observaciones. La diagonal es cero porque es la distancia entre cada
observación con ella misma.</p>
<p>Por ejemplo: la distancia Euclidiana entre la observación uno y dos es
2,9. Resta al cuadrado de la fila 1 con la fila 2 y el resultado se saca
raíz cuadrada así:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">((</span><span class="n">df_scaled</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">-</span><span class="n">df_scaled</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">])</span><span class="o">^</span><span class="m">2</span><span class="o">+</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">-</span><span class="n">df_scaled</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">])</span><span class="o">^</span><span class="m">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">2.908863</span>
</pre></div>
</div>
<p>Se sacará la matriz para las distancias entre las primeras 10
observaciones.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">dist_eucl</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">],</span> <span class="m">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">3</span>   <span class="mi">4</span>   <span class="mi">5</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">8</span>   <span class="mi">9</span>  <span class="mi">10</span>
<span class="mi">1</span>  <span class="mf">0.0</span> <span class="mf">2.9</span> <span class="mf">3.1</span> <span class="mf">1.3</span> <span class="mf">1.9</span> <span class="mf">1.8</span> <span class="mf">1.5</span> <span class="mf">1.6</span> <span class="mf">1.1</span> <span class="mf">3.5</span>
<span class="mi">2</span>  <span class="mf">2.9</span> <span class="mf">0.0</span> <span class="mf">0.7</span> <span class="mf">4.2</span> <span class="mf">4.7</span> <span class="mf">3.8</span> <span class="mf">2.7</span> <span class="mf">4.4</span> <span class="mf">1.8</span> <span class="mf">0.7</span>
<span class="mi">3</span>  <span class="mf">3.1</span> <span class="mf">0.7</span> <span class="mf">0.0</span> <span class="mf">4.3</span> <span class="mf">4.7</span> <span class="mf">4.2</span> <span class="mf">3.2</span> <span class="mf">4.6</span> <span class="mf">2.0</span> <span class="mf">0.6</span>
<span class="mi">4</span>  <span class="mf">1.3</span> <span class="mf">4.2</span> <span class="mf">4.3</span> <span class="mf">0.0</span> <span class="mf">0.6</span> <span class="mf">2.3</span> <span class="mf">2.6</span> <span class="mf">1.1</span> <span class="mf">2.4</span> <span class="mf">4.8</span>
<span class="mi">5</span>  <span class="mf">1.9</span> <span class="mf">4.7</span> <span class="mf">4.7</span> <span class="mf">0.6</span> <span class="mf">0.0</span> <span class="mf">2.8</span> <span class="mf">3.2</span> <span class="mf">1.6</span> <span class="mf">3.0</span> <span class="mf">5.2</span>
<span class="mi">6</span>  <span class="mf">1.8</span> <span class="mf">3.8</span> <span class="mf">4.2</span> <span class="mf">2.3</span> <span class="mf">2.8</span> <span class="mf">0.0</span> <span class="mf">1.1</span> <span class="mf">1.4</span> <span class="mf">2.3</span> <span class="mf">4.5</span>
<span class="mi">7</span>  <span class="mf">1.5</span> <span class="mf">2.7</span> <span class="mf">3.2</span> <span class="mf">2.6</span> <span class="mf">3.2</span> <span class="mf">1.1</span> <span class="mf">0.0</span> <span class="mf">2.1</span> <span class="mf">1.4</span> <span class="mf">3.4</span>
<span class="mi">8</span>  <span class="mf">1.6</span> <span class="mf">4.4</span> <span class="mf">4.6</span> <span class="mf">1.1</span> <span class="mf">1.6</span> <span class="mf">1.4</span> <span class="mf">2.1</span> <span class="mf">0.0</span> <span class="mf">2.6</span> <span class="mf">5.0</span>
<span class="mi">9</span>  <span class="mf">1.1</span> <span class="mf">1.8</span> <span class="mf">2.0</span> <span class="mf">2.4</span> <span class="mf">3.0</span> <span class="mf">2.3</span> <span class="mf">1.4</span> <span class="mf">2.6</span> <span class="mf">0.0</span> <span class="mf">2.4</span>
<span class="mi">10</span> <span class="mf">3.5</span> <span class="mf">0.7</span> <span class="mf">0.6</span> <span class="mf">4.8</span> <span class="mf">5.2</span> <span class="mf">4.5</span> <span class="mf">3.4</span> <span class="mf">5.0</span> <span class="mf">2.4</span> <span class="mf">0.0</span>
</pre></div>
</div>
</div>
<div class="section" id="k-means">
<h2>K-Means:<a class="headerlink" href="#k-means" title="Permalink to this headline"></a></h2>
<p>La función más usada es <code class="docutils literal notranslate"><span class="pre">kmeans()</span></code> de la librería <code class="docutils literal notranslate"><span class="pre">stats</span></code>.</p>
<p>Instalar el siguiente paquete: <code class="docutils literal notranslate"><span class="pre">install.packages(&quot;stats&quot;)</span></code></p>
<p><strong>sintaxis:</strong> <code class="docutils literal notranslate"><span class="pre">kmeans(x,</span> <span class="pre">centers,</span> <span class="pre">iter.max</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">nstart</span> <span class="pre">=</span> <span class="pre">1)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code>: Data Frame con los datos, agregaremos las distancias calculadas
con <code class="docutils literal notranslate"><span class="pre">dist()</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">centers</span></code>: son los <span class="math notranslate nohighlight">\(k\)</span> clusters iniciales.</p>
<p><code class="docutils literal notranslate"><span class="pre">iter.max</span></code>: número máximo de iteraciones. Por defecto es 10.</p>
<p><code class="docutils literal notranslate"><span class="pre">nstart</span></code>: número de particiones iniciales aleatorias cuando
<code class="docutils literal notranslate"><span class="pre">centers</span></code> es un número. Probar con <code class="docutils literal notranslate"><span class="pre">nstart</span> <span class="pre">&gt;</span> <span class="pre">1</span></code></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="c1"># valor semilla para obtener siempre los mismos resultados.</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">names</span><span class="p">(</span><span class="nf">kmeans</span><span class="p">(</span><span class="n">dist_eucl</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span>
</pre></div>
</div>
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'cluster'</li><li>'centers'</li><li>'totss'</li><li>'withinss'</li><li>'tot.withinss'</li><li>'betweenss'</li><li>'size'</li><li>'iter'</li><li>'ifault'</li></ol><p><code class="docutils literal notranslate"><span class="pre">cluster</span></code>: un vector de enteros (desde 1:k) que indica el cluster al
que se asigna cada punto.</p>
<p><code class="docutils literal notranslate"><span class="pre">centers</span></code>: una matriz con los centroides.</p>
<p><code class="docutils literal notranslate"><span class="pre">withinss</span></code>: vector con los WCSS de cada cluster. El resultado es
después de definir la cantidad de clusters.</p>
<p><code class="docutils literal notranslate"><span class="pre">size</span></code>: cantidad de puntos en cada cluster.</p>
</div>
<div class="section" id="numero-optimo-de-clusters">
<h2>Número óptimo de clusters:<a class="headerlink" href="#numero-optimo-de-clusters" title="Permalink to this headline"></a></h2>
<p><strong>Método del codo:</strong></p>
<p>Se calculará el valor de WCSS aplicando K-Means aumentando la cantidad
de centroides.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wcss</span> <span class="o">=</span> <span class="nf">vector</span><span class="p">()</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">){</span>
  <span class="n">wcss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="nf">kmeans</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span><span class="o">$</span><span class="n">withinss</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">ggplot</span><span class="p">()</span><span class="o">+</span><span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">wcss</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span>  <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;darkred&quot;</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Método del codo&quot;</span><span class="p">,</span>
         <span class="n">x</span> <span class="o">=</span> <span class="s">&quot;k clusters&quot;</span><span class="p">,</span>
         <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;WCSS&quot;</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">theme_light</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_34_0.png"><img alt="../../_images/output_34_0.png" src="../../_images/output_34_0.png" style="width: 420px; height: 420px;" /></a>
<p>Este método también lo podemos hacer con la función <code class="docutils literal notranslate"><span class="pre">fviz_nbclust()</span></code>
del paquete <code class="docutils literal notranslate"><span class="pre">factoextra</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">install.packages(&quot;factoextra&quot;)</span></code></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">factoextra</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Warning message:
&quot;package &#39;factoextra&#39; was built under R version 4.1.3&quot;
Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">fviz_nbclust</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">,</span> <span class="n">kmeans</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;wss&quot;</span><span class="p">)</span> <span class="o">+</span>
    <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">linetype</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">labs</span><span class="p">(</span><span class="n">subtitle</span> <span class="o">=</span> <span class="s">&quot;Método del codo&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_37_0.png"><img alt="../../_images/output_37_0.png" src="../../_images/output_37_0.png" style="width: 420px; height: 420px;" /></a>
</div>
<div class="section" id="metodo-de-la-silueta">
<h2>Método de la silueta:<a class="headerlink" href="#metodo-de-la-silueta" title="Permalink to this headline"></a></h2>
<p>Este método también lo hacemos con la función <code class="docutils literal notranslate"><span class="pre">fviz_nbclust()</span></code></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">fviz_nbclust</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">,</span> <span class="n">kmeans</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;silhouette&quot;</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">labs</span><span class="p">(</span><span class="n">subtitle</span> <span class="o">=</span> <span class="s">&quot;Método de la silueta&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_40_0.png"><img alt="../../_images/output_40_0.png" src="../../_images/output_40_0.png" style="width: 420px; height: 420px;" /></a>
</div>
<div class="section" id="metodo-del-gap-estadistico">
<h2>Método del gap estadístico:<a class="headerlink" href="#metodo-del-gap-estadistico" title="Permalink to this headline"></a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">fviz_nbclust</span><span class="p">(</span><span class="n">df_scaled</span><span class="p">,</span> <span class="n">kmeans</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;gap_stat&quot;</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">labs</span><span class="p">(</span><span class="n">subtitle</span> <span class="o">=</span> <span class="s">&quot;Gap statistic method&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_42_01.png"><img alt="../../_images/output_42_01.png" src="../../_images/output_42_01.png" style="width: 420px; height: 420px;" /></a>
</div>
<div class="section" id="aplicacion-del-k-means-con-k-optimo">
<h2>Aplicación del K-Means con k óptimo:<a class="headerlink" href="#aplicacion-del-k-means-con-k-optimo" title="Permalink to this headline"></a></h2>
<p><span class="math notranslate nohighlight">\(k = 3\)</span>:</p>
<p>Recomiendo llamar el modelo de cualquier forma diferente a <code class="docutils literal notranslate"><span class="pre">kmeans</span></code>
por este nombre se utiliza para algunas librerías como función y no como
una variable; por ejemplo, guardemos el resultado con el nombre de
<code class="docutils literal notranslate"><span class="pre">k_means</span></code>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">k_means</span> <span class="o">&lt;-</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">dist_eucl</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="n">iter.max</span> <span class="o">=</span> <span class="m">300</span><span class="p">,</span> <span class="n">nstart</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Cantidad de observaciones por cada cluster:</strong></p>
<p>¿Cómo cambia este resultado para 3 clusters?</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">k_means</span><span class="o">$</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="mi">15</span>  <span class="mi">46</span> <span class="mi">155</span>
</pre></div>
</div>
<p>Para visualizar los clusters en los datos originales usaremos la función
<code class="docutils literal notranslate"><span class="pre">clusplot()</span></code> del paquete <code class="docutils literal notranslate"><span class="pre">cluster</span></code>.</p>
<p>Instalar el paquete: <code class="docutils literal notranslate"><span class="pre">install.packages(&quot;cluster&quot;)</span></code></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span> <span class="n">message</span><span class="p">:</span>
<span class="s2">&quot;package &#39;cluster&#39; was built under R version 4.1.3&quot;</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">clusplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
         <span class="n">k_means</span><span class="o">$</span><span class="n">cluster</span><span class="p">,</span>       <span class="c1"># el cluster que se le asigna a cada punto.</span>
         <span class="n">lines</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span>            <span class="c1"># para eliminar líneas en el gráfico.</span>
         <span class="n">labels</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span>           <span class="c1"># 4 para que ponga una etiqueta al número del cluster.</span>
         <span class="n">color</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>         <span class="c1"># diferente colo para cada sector.</span>
         <span class="n">plotchar</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>     <span class="c1"># con FALSE se quitan los símbolos diferentes para cada cluster.</span>
         <span class="n">span</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>          <span class="c1"># TRUE para que represente el cluster con una elipse no como círculo.</span>
         <span class="n">main</span> <span class="o">=</span> <span class="s">&quot;Clustering de empresas&quot;</span><span class="p">,</span>
         <span class="n">xlab</span> <span class="o">=</span> <span class="s">&quot;Activos Totales&quot;</span><span class="p">,</span>
         <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;Ingresos Operacionales&quot;</span>
         <span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_51_01.png"><img alt="../../_images/output_51_01.png" src="../../_images/output_51_01.png" style="width: 420px; height: 420px;" /></a>
<p>Otra forma de visualizar los cluster con <code class="docutils literal notranslate"><span class="pre">fviz_cluster()</span></code></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">fviz_cluster</span><span class="p">(</span><span class="n">k_means</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span>
             <span class="n">stand</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>            <span class="c1"># FALSE para que no estandarice los datos, ya se había hecho esto.</span>
             <span class="n">show.clust.cent</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>   <span class="c1"># TRUE para que muestre los centroides.</span>
             <span class="n">ellipse</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>              <span class="c1"># Puede ser FALSE o TRUE</span>
             <span class="n">ggtheme</span> <span class="o">=</span> <span class="nf">theme_minimal</span><span class="p">())</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_53_01.png"><img alt="../../_images/output_53_01.png" src="../../_images/output_53_01.png" style="width: 420px; height: 420px;" /></a>
<p>Es posible calcular la media de cada variable por cluster utilizando los
datos originales:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">aggregate</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">cluster</span> <span class="o">=</span> <span class="n">k_means</span><span class="o">$</span><span class="n">cluster</span><span class="p">),</span> <span class="n">mean</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">cluster</span> <span class="n">Gasto_personal</span>    <span class="n">Ventas</span>
<span class="mi">1</span>       <span class="mi">1</span>       <span class="mi">46055433</span> <span class="mi">390956062</span>
<span class="mi">2</span>       <span class="mi">2</span>       <span class="mi">19831448</span> <span class="mi">197627597</span>
<span class="mi">3</span>       <span class="mi">3</span>        <span class="mi">6394092</span>  <span class="mi">43446519</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(k = 6\)</span>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">k_means</span> <span class="o">&lt;-</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">dist_eucl</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="n">iter.max</span> <span class="o">=</span> <span class="m">300</span><span class="p">,</span> <span class="n">nstart</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">k_means</span><span class="o">$</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>   <span class="mi">2</span> <span class="mi">115</span>  <span class="mi">37</span>  <span class="mi">12</span>  <span class="mi">20</span>  <span class="mi">30</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">fviz_cluster</span><span class="p">(</span><span class="n">k_means</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span>
             <span class="n">stand</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>            <span class="c1"># FALSE para que no estandarice los datos, ya se había hecho esto.</span>
             <span class="n">show.clust.cent</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>   <span class="c1"># TRUE para que muestre los centroides.</span>
             <span class="n">ellipse</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>              <span class="c1"># Puede ser FALSE o TRUE</span>
             <span class="n">ggtheme</span> <span class="o">=</span> <span class="nf">theme_minimal</span><span class="p">())</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_58_01.png"><img alt="../../_images/output_58_01.png" src="../../_images/output_58_01.png" style="width: 420px; height: 420px;" /></a>
<p><strong>Realizar el K-Means con distancias Manhattan y Minkowski con p igual
0.1, 0.5, 3 y 4.</strong></p>
<p><strong>Realizar lo anterior, pero sin estandarizar las variables</strong></p>
<p><strong>¿Para este caso en específico será necesario la estandarización de
variables?</strong></p>
<p><strong>Realizar el K-Means con las siguientes variables: Inversión en AF y
Ventas</strong></p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Teor%C3%ADa%20K-Means/Teor%C3%ADa%20K-Means.html" class="btn btn-neutral float-left" title="Teoría K-Means" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Clustering%20jerarquico/Cluster_jer%C3%A1rquico.html" class="btn btn-neutral float-right" title="Clusters Jerárquicos" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Natalia Acevedo Prins.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>