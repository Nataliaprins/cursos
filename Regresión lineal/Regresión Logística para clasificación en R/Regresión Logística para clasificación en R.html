<!DOCTYPE html>
<html class="writer-html5" lang="y" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Regresión Logística para clasificación en R &mdash; Material Curso 1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Análisis Multivariado" href="../../Multivariado/index.html" />
    <link rel="prev" title="Regresión Logística para clasificación" href="../Regresi%C3%B3n%20Log%C3%ADstica%20para%20clasificaci%C3%B3n/Regresi%C3%B3n%20Log%C3%ADstica%20para%20clasificaci%C3%B3n.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Material Curso
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Análisis de datos:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Introducci%C3%B3n%20a%20R/index.html">Introducción a R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ggplot2/index.html">ggplot2</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Regresión lineal</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#regresion-lineal-simple-rls">Regresión Lineal Simple - RLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#regresion-lineal-multiple-rlm">Regresión Lineal Múltiple - RLM</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#regresion-logistica">Regresión Logística</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../Teor%C3%ADa%20Regresi%C3%B3n%20Log%C3%ADstica/Teor%C3%ADa%20Regresi%C3%B3n%20Log%C3%ADstica.html">Teoría Regresión Logística</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Regresi%C3%B3n%20Log%C3%ADstica%20en%20R/Regresi%C3%B3n%20Log%C3%ADstica%20en%20R.html">Regresión Logística en R</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Regresi%C3%B3n%20Log%C3%ADstica%20para%20clasificaci%C3%B3n/Regresi%C3%B3n%20Log%C3%ADstica%20para%20clasificaci%C3%B3n.html">Regresión Logística para clasificación</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Regresión Logística para clasificación en R</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ajuste-modelo-multiple">Ajuste modelo múltiple:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#curva-roc">Curva ROC:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matriz-de-confusion">Matriz de confusión:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metricas">Métricas:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Multivariado/index.html">Análisis Multivariado</a></li>
</ul>
<p class="caption"><span class="caption-text">Análisis exploratorio de datos:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20gr%C3%A1fico/index.html">Análisis gráfico</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20multivariado%20de%20datos/index.html">Análisis multivariado de datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20de%20componentes%20principales/index.html">Análisis de componentes principales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lisis%20factorial/index.html">Análisis Factorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Clustering/index.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Escalamiento%20Multidimensional/index.html">Escalamiento Multidimensional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Datos%20faltantes/index.html">Datos faltantes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../An%C3%A1lsis%20de%20correspondencia/index.html">Análisis de correspondencia</a></li>
</ul>
<p class="caption"><span class="caption-text">Teoría de portafolios:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Generalidades%20del%20Mercado%20Colombiano/index.html">Generalidades del Mercado Colombiano</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Manejo%20de%20R-Studio/index.html">Conceptos Previos: Introducción a R y R-Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Conceptos%20B%C3%A1sicos%20de%20Estad%C3%ADstica/index.html">Conceptos Básicos de Estadística</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Teor%C3%ADa%20de%20Portafolios/index.html">Teoría de Portafolios</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Selecci%C3%B3n%20de%20Carteras/index.html">Selección de Cartera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Mercado%20de%20Renta%20Fija/index.html">Mercado de Renta fija</a></li>
</ul>
<p class="caption"><span class="caption-text">Modelación:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Caracterizaci%C3%B3n%20de%20las%20series%20de%20tiempo/index.html">Caracterización de las series de tiempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Modelos%20autorregresivos/index.html">ARIMA: autoregresivo integrado de medias móviles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Deep%20Learning%20para%20pron%C3%B3stico/index.html">Deep Learning para pronóstico</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Material Curso</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Regresión lineal</a> &raquo;</li>
      <li>Regresión Logística para clasificación en R</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Regresión lineal/Regresión Logística para clasificación en R/Regresión Logística para clasificación en R.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="regresion-logistica-para-clasificacion-en-r">
<h1>Regresión Logística para clasificación en R<a class="headerlink" href="#regresion-logistica-para-clasificacion-en-r" title="Permalink to this headline"></a></h1>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span> <span class="o">=</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Social_Network_Ads.csv&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="s">&quot;.&quot;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">datos</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">User</span><span class="o">.</span><span class="n">ID</span> <span class="n">Gender</span> <span class="n">Age</span> <span class="n">EstimatedSalary</span> <span class="n">Purchased</span>
<span class="mi">1</span> <span class="mi">15624510</span>   <span class="n">Male</span>  <span class="mi">19</span>           <span class="mi">19000</span>         <span class="mi">0</span>
<span class="mi">2</span> <span class="mi">15810944</span>   <span class="n">Male</span>  <span class="mi">35</span>           <span class="mi">20000</span>         <span class="mi">0</span>
<span class="mi">3</span> <span class="mi">15668575</span> <span class="n">Female</span>  <span class="mi">26</span>           <span class="mi">43000</span>         <span class="mi">0</span>
<span class="mi">4</span> <span class="mi">15603246</span> <span class="n">Female</span>  <span class="mi">27</span>           <span class="mi">57000</span>         <span class="mi">0</span>
<span class="mi">5</span> <span class="mi">15804002</span>   <span class="n">Male</span>  <span class="mi">19</span>           <span class="mi">76000</span>         <span class="mi">0</span>
<span class="mi">6</span> <span class="mi">15728773</span>   <span class="n">Male</span>  <span class="mi">27</span>           <span class="mi">58000</span>         <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">str</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&#39;data.frame&#39;:       400 obs. of  5 variables:
 $ User.ID        : int  15624510 15810944 15668575 15603246 15804002 15728773 15598044 15694829 15600575 15727311 ...
 $ Gender         : chr  &quot;Male&quot; &quot;Male&quot; &quot;Female&quot; &quot;Female&quot; ...
 $ Age            : int  19 35 26 27 19 27 27 32 25 35 ...
 $ EstimatedSalary: int  19000 20000 43000 57000 76000 58000 84000 150000 33000 65000 ...
 $ Purchased      : int  0 0 0 0 0 0 0 1 0 0 ...
</pre></div>
</div>
<p><strong>Variables:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">&lt;-</span> <span class="n">datos</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Gender&quot;</span><span class="p">,</span> <span class="s">&quot;Age&quot;</span><span class="p">,</span> <span class="s">&quot;EstimatedSalary&quot;</span><span class="p">,</span> <span class="s">&quot;Purchased&quot;</span><span class="p">)]</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Gender</span> <span class="n">Age</span> <span class="n">EstimatedSalary</span> <span class="n">Purchased</span>
<span class="mi">1</span>   <span class="n">Male</span>  <span class="mi">19</span>           <span class="mi">19000</span>         <span class="mi">0</span>
<span class="mi">2</span>   <span class="n">Male</span>  <span class="mi">35</span>           <span class="mi">20000</span>         <span class="mi">0</span>
<span class="mi">3</span> <span class="n">Female</span>  <span class="mi">26</span>           <span class="mi">43000</span>         <span class="mi">0</span>
<span class="mi">4</span> <span class="n">Female</span>  <span class="mi">27</span>           <span class="mi">57000</span>         <span class="mi">0</span>
<span class="mi">5</span>   <span class="n">Male</span>  <span class="mi">19</span>           <span class="mi">76000</span>         <span class="mi">0</span>
<span class="mi">6</span>   <span class="n">Male</span>  <span class="mi">27</span>           <span class="mi">58000</span>         <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">dim</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">400</span>   <span class="mi">4</span>
</pre></div>
</div>
<p><strong>Variable y:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Purchased&quot;</span><span class="p">)]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="mi">0</span>   <span class="mi">1</span>
<span class="mi">257</span> <span class="mi">143</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Purchased&quot;</span><span class="p">)])</span><span class="o">/</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="mi">0</span>      <span class="mi">1</span>
<span class="mf">0.6425</span> <span class="mf">0.3575</span>
</pre></div>
</div>
<p><strong>Variable categórica:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Gender</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="s2">&quot;Male&quot;</span>   <span class="s2">&quot;Female&quot;</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">$</span><span class="n">Gender</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Gender</span><span class="p">,</span>
                    <span class="n">levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Gender</span><span class="p">)),</span>
                    <span class="n">labels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Gender</span> <span class="n">Age</span> <span class="n">EstimatedSalary</span> <span class="n">Purchased</span>
<span class="mi">1</span>      <span class="mi">1</span>  <span class="mi">19</span>           <span class="mi">19000</span>         <span class="mi">0</span>
<span class="mi">2</span>      <span class="mi">1</span>  <span class="mi">35</span>           <span class="mi">20000</span>         <span class="mi">0</span>
<span class="mi">3</span>      <span class="mi">0</span>  <span class="mi">26</span>           <span class="mi">43000</span>         <span class="mi">0</span>
<span class="mi">4</span>      <span class="mi">0</span>  <span class="mi">27</span>           <span class="mi">57000</span>         <span class="mi">0</span>
<span class="mi">5</span>      <span class="mi">1</span>  <span class="mi">19</span>           <span class="mi">76000</span>         <span class="mi">0</span>
<span class="mi">6</span>      <span class="mi">1</span>  <span class="mi">27</span>           <span class="mi">58000</span>         <span class="mi">0</span>
</pre></div>
</div>
<div class="section" id="ajuste-modelo-multiple">
<h2>Ajuste modelo múltiple:<a class="headerlink" href="#ajuste-modelo-multiple" title="Permalink to this headline"></a></h2>
<div class="math notranslate nohighlight">
\[p  = \frac{1}{1+exp \left[- \left(\beta_0+\beta_1 \times Género +\beta_2 \times Edad + \beta_3 \times Salario  \right)\right]}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">logistic</span> <span class="o">&lt;-</span> <span class="nf">glm</span><span class="p">(</span><span class="n">Purchased</span> <span class="o">~</span> <span class="n">Gender</span> <span class="o">+</span> <span class="n">Age</span> <span class="o">+</span> <span class="n">EstimatedSalary</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">)</span>
<span class="n">logistic</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Call</span><span class="p">:</span>  <span class="n">glm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">Purchased</span> <span class="o">~</span> <span class="n">Gender</span> <span class="o">+</span> <span class="n">Age</span> <span class="o">+</span> <span class="n">EstimatedSalary</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">,</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span>

<span class="n">Coefficients</span><span class="p">:</span>
    <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>          <span class="n">Gender0</span>              <span class="n">Age</span>  <span class="n">EstimatedSalary</span>
     <span class="o">-</span><span class="mf">1.245e+01</span>       <span class="o">-</span><span class="mf">3.338e-01</span>        <span class="mf">2.370e-01</span>        <span class="mf">3.644e-05</span>

<span class="n">Degrees</span> <span class="n">of</span> <span class="n">Freedom</span><span class="p">:</span> <span class="mi">399</span> <span class="n">Total</span> <span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">Null</span><span class="p">);</span>  <span class="mi">396</span> <span class="n">Residual</span>
<span class="n">Null</span> <span class="n">Deviance</span><span class="p">:</span>          <span class="mf">521.6</span>
<span class="n">Residual</span> <span class="n">Deviance</span><span class="p">:</span> <span class="mf">275.8</span>    <span class="n">AIC</span><span class="p">:</span> <span class="mf">283.8</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">logistic</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Call:
glm(formula = Purchased ~ Gender + Age + EstimatedSalary, family = binomial,
    data = df)

Deviance Residuals:
    Min       1Q   Median       3Q      Max
-2.9109  -0.5218  -0.1406   0.3662   2.4254

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)     -1.245e+01  1.309e+00  -9.510  &lt; 2e-16 <strong>*
Gender0         -3.338e-01  3.052e-01  -1.094    0.274
Age              2.370e-01  2.638e-02   8.984  &lt; 2e-16 *</strong>
EstimatedSalary  3.644e-05  5.473e-06   6.659 2.77e-11 <strong>*
---
Signif. codes:  0 '*</strong>' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 521.57  on 399  degrees of freedom
Residual deviance: 275.84  on 396  degrees of freedom
AIC: 283.84

Number of Fisher Scoring iterations: 6</pre>
</div>
<div class="section" id="curva-roc">
<h2>Curva ROC:<a class="headerlink" href="#curva-roc" title="Permalink to this headline"></a></h2>
<p><strong>Punto de corte:</strong></p>
<p>Definiremos el punto de corte con la probabilidad del 70%.</p>
<p>Cada observación tiene una probabilidad asociada que fue ajustada por el
modelo logit, <code class="docutils literal notranslate"><span class="pre">logistic$fitted.values</span></code>. Probabilidades mayores o
iguales que 0,7 será clasificadas como <span class="math notranslate nohighlight">\(1\)</span>, es decir, que sí
compraron, las demás observaciones serán clasificadas como <span class="math notranslate nohighlight">\(0\)</span>, no
compraron.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">&lt;-</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">logistic</span><span class="o">$</span><span class="n">fitted.values</span> <span class="o">&gt;=</span> <span class="m">0.7</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Age</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">EstimatedSalary</span><span class="p">,</span>
                      <span class="n">color</span> <span class="o">=</span> <span class="nf">as.factor</span><span class="p">(</span><span class="n">Purchased</span><span class="p">),</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">Gender</span><span class="p">))</span><span class="o">+</span>
    <span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">3</span><span class="p">)</span><span class="o">+</span>
    <span class="nf">labs</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;Purchased&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_21_05.png"><img alt="../../_images/output_21_05.png" src="../../_images/output_21_05.png" style="width: 420px; height: 420px;" /></a>
<p>Instalar el siguiente paquete: <code class="docutils literal notranslate"><span class="pre">install.packages('ROCR')</span></code>. Se usará la
función <code class="docutils literal notranslate"><span class="pre">ROCR()</span></code> para graficar la curva ROC, pero primero se debe
crear un objeto de predicción, se usa la función <code class="docutils literal notranslate"><span class="pre">prediction()</span></code> para
transformar los datos en un formato estándar que se pueda graficar con
la función <code class="docutils literal notranslate"><span class="pre">ROCR()</span></code>. Luego, se crea un objeto con el rendimiento del
clasificador con la función <code class="docutils literal notranslate"><span class="pre">performance()</span></code>, donde se agrega el
argumento <code class="docutils literal notranslate"><span class="pre">measure</span> <span class="pre">=</span> <span class="pre">&quot;tpr&quot;</span></code> para indicar <em>True positive rate</em> y el
argumento <code class="docutils literal notranslate"><span class="pre">x.measure</span> <span class="pre">=</span> <span class="pre">&quot;fpr&quot;</span></code> para <em>False positive rate</em> en el eje
<span class="math notranslate nohighlight">\(x\)</span> de la curva ROC.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ROCR</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span> <span class="n">message</span><span class="p">:</span>
<span class="s2">&quot;package &#39;ROCR&#39; was built under R version 4.1.3&quot;</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">prediction</span> <span class="o">&lt;-</span> <span class="nf">prediction</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">df</span><span class="o">$</span><span class="n">Purchased</span><span class="p">)</span>
<span class="n">perf</span> <span class="o">&lt;-</span> <span class="nf">performance</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">measure</span> <span class="o">=</span> <span class="s">&quot;tpr&quot;</span><span class="p">,</span> <span class="n">x.measure</span> <span class="o">=</span> <span class="s">&quot;fpr&quot;</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">perf</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/output_24_04.png"><img alt="../../_images/output_24_04.png" src="../../_images/output_24_04.png" style="width: 420px; height: 420px;" /></a>
<p>La anterior es la curva ROC para un punto de corto de 0,70.</p>
<p><strong>AUC:</strong></p>
<p>Podemos usar el paquete <code class="docutils literal notranslate"><span class="pre">ROCR</span></code> para calcular el AUC. Para hacerlo,
primero debemos crear otro objeto de <code class="docutils literal notranslate"><span class="pre">perf.auc</span></code>, esta vez
especificando <code class="docutils literal notranslate"><span class="pre">measure</span> <span class="pre">=</span> <span class="pre">&quot;auc&quot;</span></code>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">perf.auc</span> <span class="o">&lt;-</span> <span class="nf">performance</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">measure</span> <span class="o">=</span> <span class="s">&quot;auc&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Se usa <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> porque el objeto creado tiene slots.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">auc</span> <span class="o">&lt;-</span> <span class="nf">unlist</span><span class="p">(</span><span class="n">perf.auc</span><span class="o">@</span><span class="n">y.values</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">auc</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.754823</span>
</pre></div>
</div>
</div>
<div class="section" id="matriz-de-confusion">
<h2>Matriz de confusión:<a class="headerlink" href="#matriz-de-confusion" title="Permalink to this headline"></a></h2>
<p>Antes de mostrar la matriz de confusión hagamos estos cálculos:</p>
<p><strong>Cantidad de valores predichos como 1 (TP + FP):</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">90</span>
</pre></div>
</div>
<p><strong>Cantidad de valores predichos como 0 (FN + TN):</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span> <span class="o">-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">310</span>
</pre></div>
</div>
<p><strong>Cantidad de observaciones actuales que son 1:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">143</span>
</pre></div>
</div>
<p><strong>Cantidad de observaciones actuales que son 0:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span><span class="p">)</span> <span class="o">-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">257</span>
</pre></div>
</div>
<p><strong>Predicciones correctas de la categoría 1 (Verdaderos Positivos -
TP):</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span> <span class="o">==</span> <span class="m">1</span> <span class="o">&amp;</span> <span class="n">y_pred</span> <span class="o">==</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">79</span>
</pre></div>
</div>
<p><strong>Predicciones correctas para la categoría 0 (Verdaderos Negativos -
TN):</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span> <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;</span> <span class="n">y_pred</span> <span class="o">==</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">246</span>
</pre></div>
</div>
<p><strong>Predicciones correctas en total:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span> <span class="o">==</span> <span class="n">y_pred</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">325</span>
</pre></div>
</div>
<p><strong>Cantidad de predicciones incorrectas para la categoría 1 (Falso
negativo - FN - Error tipo 2):</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span> <span class="o">==</span> <span class="m">1</span> <span class="o">&amp;</span> <span class="n">y_pred</span> <span class="o">==</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">64</span>
</pre></div>
</div>
<p><strong>Cantidad de predicciones incorrectas para la categoría 0 (Falso
positivo - FP - Error tipo 1):</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span> <span class="o">==</span> <span class="m">0</span> <span class="o">&amp;</span> <span class="n">y_pred</span> <span class="o">==</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">11</span>
</pre></div>
</div>
<p>La siguiente matriz de confusión tiene la forma:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 36%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Predicho como 0</p></th>
<th class="head"><p>Predicho como 1</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Actual 0</strong></p></td>
<td><p>TN</p></td>
<td><p>FP</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Actual 1</strong></p></td>
<td><p>FN</p></td>
<td><p>TP</p></td>
</tr>
</tbody>
</table>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">&lt;-</span> <span class="nf">table</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">Purchased</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">y_pred</span>
    <span class="mi">0</span>   <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">246</span>  <span class="mi">11</span>
<span class="mi">1</span>  <span class="mi">64</span>  <span class="mi">79</span>
</pre></div>
</div>
</div>
<div class="section" id="metricas">
<h2>Métricas:<a class="headerlink" href="#metricas" title="Permalink to this headline"></a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">TP</span> <span class="o">&lt;-</span> <span class="n">cm</span><span class="p">[</span><span class="m">4</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">TP</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">79</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">TN</span> <span class="o">&lt;-</span> <span class="n">cm</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">TN</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">246</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">FN</span> <span class="o">&lt;-</span> <span class="n">cm</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">FN</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">64</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">FP</span> <span class="o">&lt;-</span> <span class="n">cm</span><span class="p">[</span><span class="m">3</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">FP</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">11</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">cm</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">400</span>
</pre></div>
</div>
<p><strong>Accuracy:</strong></p>
<div class="math notranslate nohighlight">
\[accuracy = \frac{TP+TN}{TP+TN+FP+FN}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">TN</span><span class="p">)</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.8125</span>
</pre></div>
</div>
<p><strong>Error Rate:</strong></p>
<div class="math notranslate nohighlight">
\[ErrorRate = \frac{FP+FN}{TP+TN+FP+FN} = 1 - accuracy\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">FP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.1875</span>
</pre></div>
</div>
<p><strong>Sensitivity:</strong></p>
<div class="math notranslate nohighlight">
\[sensitivity = \frac{TP}{TP+FN}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sensitivity</span> <span class="o">&lt;-</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">sensitivity</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.5524476</span>
</pre></div>
</div>
<p><strong>Specificity:</strong></p>
<div class="math notranslate nohighlight">
\[specificity = \frac{TN}{TN+FP}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">specificity</span> <span class="o">&lt;-</span> <span class="n">TN</span><span class="o">/</span><span class="p">(</span><span class="n">TN</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">specificity</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.9571984</span>
</pre></div>
</div>
<p><strong>Precision:</strong></p>
<div class="math notranslate nohighlight">
\[precision = \frac{TP}{TP+FP}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">precision</span> <span class="o">&lt;-</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.8777778</span>
</pre></div>
</div>
<p><strong>Recall:</strong></p>
<div class="math notranslate nohighlight">
\[recall = \frac{TP}{TP+FN}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">recall</span> <span class="o">&lt;-</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.5524476</span>
</pre></div>
</div>
<p><strong>F-measure:</strong></p>
<div class="math notranslate nohighlight">
\[F-measure = \frac{2 \times precision \times recall}{recall + precision} = \frac{2 \times TP}{2 \times TP + FP + FN}\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">F1</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="n">precision</span><span class="o">*</span><span class="n">recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">recall</span><span class="o">+</span><span class="n">precision</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.6781116</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">F1</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="n">TP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="m">2</span><span class="o">*</span><span class="n">TP</span><span class="o">+</span><span class="n">FP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">F1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">0.6781116</span>
</pre></div>
</div>
<p><strong>¿Cómo cambian los resultados si el punto de corte es con una
probabilidad de 0,50?</strong></p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../Regresi%C3%B3n%20Log%C3%ADstica%20para%20clasificaci%C3%B3n/Regresi%C3%B3n%20Log%C3%ADstica%20para%20clasificaci%C3%B3n.html" class="btn btn-neutral float-left" title="Regresión Logística para clasificación" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../Multivariado/index.html" class="btn btn-neutral float-right" title="Análisis Multivariado" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Natalia Acevedo Prins.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>